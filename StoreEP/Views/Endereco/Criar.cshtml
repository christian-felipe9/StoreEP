@model Endereco
@{
    ViewBag.Title = "Criar novo endereço";
    Layout = "_Layout";
}
<hr />
<form asp-action="Criar" method="post">
    <div class="form-row">
        <div class="form-group col-md-6">
            <div class="form-group">
                <label asp-for="Rua" class="col-form-label"></label>
                <input asp-for="Rua" type="text" class="form-control">
                <div><span asp-validation-for="Rua" class="text-danger"></span></div>
            </divd
        </div>
        <div class="form-group col-md-6">
            <div class="form-group">
                <label asp-for="Bairro" class="col-form-label"></label>
                <input asp-for="Bairro" type="text" class="form-control">
                <div><span asp-validation-for="Bairro" class="text-danger"></span></div>
            </div>
        </div>
    </div>
    <div class="form-row">
        <div class="form-group col-md-4">
            <label asp-for="Numero" class="col-form-label"></label>
            <input asp-for="Numero" type="text" class="form-control">
            <div><span asp-validation-for="Numero" class="text-danger"></span></div>
        </div>
        <div class="form-group col-md-4">
            <label asp-for="Complemento" class="col-form-label"></label>
            <input asp-for="Complemento" class="form-control" type="text">
            <div><span asp-validation-for="Complemento" class="text-danger"></span></div>
        </div>
        <div class="form-group col-md-4">
            <label asp-for="Cidade" class="col-form-label"></label>
            <input asp-for="Cidade" class="form-control" type="text">
            <div><span asp-validation-for="Cidade" class="text-danger"></span></div>
        </div>
    </div>
    <div class="form-row">
        <div class="form-group col-md-4">
            <label asp-for="Estado" class="col-form-label" for="txt_estado"></label>
            <input asp-for="Estado" class="form-control" type="text">
            <div><span asp-validation-for="Estado" class="text-danger"></span></div>
        </div>
        <div class="form-group col-md-4">
            <label asp-for="CEP" class="col-form-label"></label>
            <input asp-for="CEP" class="form-control" type="text">
            <div><span asp-validation-for="CEP" class="text-danger"></span></div>
        </div>
        <div class="form-group col-md-4">
            <label asp-for="Pais" class="col-form-label"></label>
            <input asp-for="Pais" class="form-control" type="text">
            <div><span asp-validation-for="Pais" class="text-danger"></span></div>
            <button class="btn btn-sm btn-success" type="submit" style="margin:10px 0 10px 0">Criar Endereço</button>
        </div>
    </div>
</form>
@section scripts {
    <script type="text/javascript">

        $(document).ready(function () {
            function limpa_formulário_cep() {
                $("#Rua").val("");
                $("#Bairro").val("");
                $("#Cidade").val("");
                $("#Estado").val("");
            }
            $("#CEP").mask("99999-999");
            $("#CEP").blur(function () {
                var cep = $(this).val().replace(/\D/g, '');
                if (cep != "") {
                    var validacep = /^[0-9]{8}$/;
                    if (validacep.test(cep)) {
                        $("#Rua").val("...");
                        $("#Bairro").val("...");
                        $("#Cidade").val("...");
                        $("#Estado").val("...");
                        $.getJSON("//viacep.com.br/ws/" + cep + "/json/?callback=?", function (dados) {

                            if (!("erro" in dados)) {
                                $("#Rua").val(dados.logradouro);
                                $("#Bairro").val(dados.bairro);
                                $("#Cidade").val(dados.localidade);
                                $("#Estado").val(dados.uf);
                            }
                            else {
                                limpa_formulário_cep();
                                alert("CEP não encontrado.");
                            }
                        });
                    }
                    else {
                        limpa_formulário_cep();
                        alert("Formato de CEP inválido.");
                    }
                }
                else {
                    limpa_formulário_cep();
                }
            });
        });
    </script>
}
